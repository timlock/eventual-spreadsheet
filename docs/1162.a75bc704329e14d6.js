"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1162],{1162:(D,_,c)=>{c.r(_),c.d(_,{EventualConsistentSpreadsheetPageModule:()=>k});var p=c(6814),h=c(95),r=c(5548),m=c(5785),w=c(6502),e=c(6689),T=c(8649),v=c(4499),u=c(8175);class a{constructor(){this.ydoc=new u.QW,this._cells=this.ydoc.getMap("cells"),this._columns=this.ydoc.getArray("columns"),this._rows=this.ydoc.getArray("rows"),this.keepRows=this.ydoc.getMap("keepRows"),this.keepColumns=this.ydoc.getMap("keepColumns"),this.cachedRows=[],this.cachedColumns=[]}catchUpdate(o){const n=[];this.ydoc.on(a.UPDATE_MODE,i=>{n.push(i)}),o(),this.ydoc.off(a.UPDATE_MODE,()=>{});const t=a.UPDATE_MODE===a.UPDATE_V2?u.vp(n):u.kp(n);if(0!==t.length)return t}applyUpdate(o){a.UPDATE_MODE===a.UPDATE_V2?u.cp(this.ydoc,o,this):u.NG(this.ydoc,o,this),this.cachedRows=this._rows.toArray().filter(n=>void 0!==this.keepRows.get(n)),this.cachedColumns=this._columns.toArray().filter(n=>void 0!==this.keepColumns.get(n))}encodeStateAsUpdate(o){return a.UPDATE_MODE===a.UPDATE_V2?u.ir(this.ydoc,o):u.D$(this.ydoc,o)}addRow(o){return this.catchUpdate(()=>{this._rows.push([o]),this.keepRows.set(o,this.ydoc.clientID),this.cachedRows.push(o)})}insertRow(o,n){const t=this.rows.indexOf(n);if(-1!==t)return this.catchUpdate(()=>{this._rows.insert(t,[o]),this.keepRows.set(o,this.ydoc.clientID),this.cachedRows.splice(t,0,o)});console.log("Failed to insert id:"+o+" before id: "+n+" in rows: "+this.rows)}deleteRow(o){const n=this.rows.indexOf(o);if(-1!==n)return this.keepRows.has(o)?this.catchUpdate(()=>{this.keepRows.delete(o),this.cachedRows.splice(n,1)}):void 0;console.log("Failed to remove id:"+o+" in rows: "+this.rows)}addColumn(o){return this.catchUpdate(()=>{this._columns.push([o]),this.keepColumns.set(o,this.ydoc.clientID),this.cachedColumns.push(o)})}insertColumn(o,n){const t=this.columns.indexOf(n);if(-1!==t)return this.catchUpdate(()=>{this._columns.insert(t,[o]),this.keepColumns.set(o,this.ydoc.clientID),this.cachedColumns.splice(t,0,o)});console.log("Failed to insert id:"+o+" before id: "+n+" in columns: "+this.columns)}deleteColumn(o){const n=this.columns.indexOf(o);if(-1!==n)return this.keepColumns.has(o)?this.catchUpdate(()=>{this.keepColumns.delete(o),this.cachedColumns.splice(n,1)}):void 0;console.log("Failed to remove id:"+o+" in columns: "+this.columns)}deleteValue(o){return this.catchUpdate(()=>{this._cells.delete(JSON.stringify(o))})}get(o){return this._cells.get(JSON.stringify(o))}set(o,n){return this.catchUpdate(()=>{this._cells.set(JSON.stringify(o),n),this.keepRows.set(o.row,this.ydoc.clientID),this.keepColumns.set(o.column,this.ydoc.clientID)})}getCellRange(o,n){return this.getAddressRange(o,n).filter(t=>null!=this.get(t)).map(t=>this.get(t))}getAddressRange(o,n){const t=this.columns.indexOf(o.column),i=this.rows.indexOf(o.row),l=this.columns.indexOf(n.column),d=this.rows.indexOf(n.row);if(-1===t||-1===i||-1===l||-1===d)return[];const g=this.rows.slice(i,d+1),O=this.columns.slice(t,l+1),C=[];for(const R of g)for(const N of O)C.push({column:N,row:R});return C}get rows(){return this.cachedRows}get columns(){return this.cachedColumns}get yjsId(){return this.ydoc.clientID}}a.UPDATE_V2="updateV2",a.UPDATE_V1="update",a.UPDATE_MODE=a.UPDATE_V1;var Z=c(5377);let M=(()=>{class s{constructor(){this.inputTable=new a,this.spreadsheetSolver=new Z.O(this.inputTable)}applyUpdate(n){this.inputTable.applyUpdate(n),this.spreadsheetSolver.reset()}addRow(n){const t=this.inputTable.addRow(n);return this.spreadsheetSolver.reset(),t}insertRow(n,t){const i=this.inputTable.insertRow(n,t);return this.spreadsheetSolver.reset(),void 0===i&&console.warn("Update is undefined"),i}deleteRow(n){const t=this.inputTable.deleteRow(n);return this.spreadsheetSolver.reset(),void 0===t&&console.warn("Update is undefined"),t}addColumn(n){const t=this.inputTable.addColumn(n);return this.spreadsheetSolver.reset(),void 0===t&&console.warn("Update is undefined"),t}insertColumn(n,t){const i=this.inputTable.insertColumn(n,t);return this.spreadsheetSolver.reset(),void 0===i&&console.warn("Update is undefined"),i}deleteColumn(n){const t=this.inputTable.deleteColumn(n);return this.spreadsheetSolver.reset(),void 0===t&&console.warn("Update is undefined"),t}set(n,t){if(0===t.trim().length)return this.deleteCell(n);const i=v.b.parseCell(t),l=this.inputTable.set(n,i);return this.spreadsheetSolver.reset(),void 0===l&&console.warn("Update is undefined"),l}deleteCell(n){const t=this.inputTable.deleteValue(n);return this.spreadsheetSolver.reset(),void 0===t&&console.warn("Update is undefined"),t}renderTable(){return this.spreadsheetSolver.solve()}get rows(){return this.inputTable.rows}get columns(){return this.inputTable.columns}getEncodedState(n){return this.inputTable.encodeStateAsUpdate(n)}}return s.\u0275fac=function(n){return new(n||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var S=c(367);function b(s,o){if(1&s){const n=e.EpF();e.TgZ(0,"div")(1,"form",4),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.insertCell(i.currentCell.address,i.input))}),e.TgZ(2,"ion-input",20),e.NdJ("ngModelChange",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.input=i)}),e.qZA()()()}if(2&s){const n=e.oxw();e.xp6(2),e.Q6J("ngModel",n.input)}}function E(s,o){if(1&s){const n=e.EpF();e.TgZ(0,"th",21)(1,"ion-toolbar")(2,"ion-buttons",22)(3,"ion-button",23),e.NdJ("click",function(){const l=e.CHM(n).$implicit,d=e.oxw();return e.KtG(d.insertColumn(l))}),e._UZ(4,"ion-icon",18),e.qZA()(),e._uU(5),e.TgZ(6,"ion-buttons",24)(7,"ion-button",25),e.NdJ("click",function(){const l=e.CHM(n).$implicit,d=e.oxw();return e.KtG(d.deleteColumn(l))}),e._UZ(8,"ion-icon",26),e.qZA()()()()}if(2&s){const n=o.index;e.xp6(5),e.hij(" ",n+1," ")}}const f=function(s,o){return{column:s,row:o}};function x(s,o){if(1&s&&(e.TgZ(0,"div")(1,"div",31),e._uU(2),e.qZA()()),2&s){const n=e.oxw().$implicit,t=e.oxw().$implicit,i=e.oxw();let l;e.xp6(2),e.hij(" ",null==(l=i.spreadsheet.renderTable().get(e.WLB(1,f,n,t)))?null:l.content," ")}}function P(s,o){if(1&s&&e._uU(0),2&s){const n=e.oxw().$implicit,t=e.oxw().$implicit,i=e.oxw();let l;e.hij(" ",null==(l=i.spreadsheet.renderTable().get(e.WLB(1,f,n,t)))?null:l.content," ")}}function y(s,o){if(1&s){const n=e.EpF();e.TgZ(0,"td",28),e.NdJ("click",function(){const l=e.CHM(n).$implicit,d=e.oxw().$implicit,g=e.oxw();return e.KtG(g.selectCell(l,d))}),e.YNc(1,x,3,4,"div",29),e.YNc(2,P,1,4,"ng-template",null,30,e.W1O),e.qZA()}if(2&s){const n=o.$implicit,t=e.MAs(3),i=e.oxw().$implicit,l=e.oxw();e.xp6(1),e.Q6J("ngIf",void 0!==l.currentCell&&l.currentCell.address.row===i&&l.currentCell.address.column===n)("ngIfElse",t)}}function U(s,o){if(1&s){const n=e.EpF();e.TgZ(0,"tr")(1,"td",15)(2,"ion-toolbar")(3,"ion-buttons",22)(4,"ion-button",23),e.NdJ("click",function(){const l=e.CHM(n).$implicit,d=e.oxw();return e.KtG(d.insertRow(l))}),e._UZ(5,"ion-icon",18),e.qZA()(),e._uU(6),e.TgZ(7,"ion-buttons",24)(8,"ion-button",25),e.NdJ("click",function(){const l=e.CHM(n).$implicit,d=e.oxw();return e.KtG(d.deleteRow(l))}),e._UZ(9,"ion-icon",26),e.qZA()()()(),e.YNc(10,y,4,2,"td",27),e.qZA()}if(2&s){const n=o.index,t=e.oxw();e.xp6(6),e.hij(" ",n+1," "),e.xp6(4),e.Q6J("ngForOf",t.spreadsheet.renderTable().columns)}}const A=[{path:"",component:(()=>{class s extends w.H{constructor(n,t,i,l){super(i,n,t,s.TAG,l)}}return s.TAG="eventual-consistent",s.\u0275fac=function(n){return new(n||s)(e.Y36(T.M),e.Y36(M),e.Y36(S.x),e.Y36(e.z2F))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-eventual-consistent-spreadsheet"]],features:[e.qOj],decls:90,vars:19,consts:[[3,"fullscreen"],["color","tertiary"],["size","large"],[3,"click"],[3,"submit"],["name","growInput","type","number","fill","outline","label","Grow",3,"ngModel","ngModelChange"],["lines","none"],["justify","start",3,"ngModel","ngModelChange"],["type","number","fill","outline","label","Test size",3,"ngModel","ngModelChange"],["type","number","fill","outline","label","Number of tests",3,"ngModel","ngModelChange"],["size","auto"],[3,"ngModel","ngModelChange"],[1,"ion-padding-top"],[4,"ngIf"],[1,"spreadsheet"],[1,"table-header","small-cell"],["class","table-header cell",4,"ngFor","ngForOf"],["color","primary",3,"click"],["name","add"],[4,"ngFor","ngForOf"],["name","eventual-consistent","fill","outline",3,"ngModel","ngModelChange"],[1,"table-header","cell"],["slot","start"],["fill","clear","size","small","color","success",3,"click"],["slot","end"],["fill","clear","size","small","color","danger",3,"click"],["name","close-circle-outline"],["class","ion-text-right cell",3,"click",4,"ngFor","ngForOf"],[1,"ion-text-right","cell",3,"click"],[4,"ngIf","ngIfElse"],["cellValue",""],[1,"selected"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-content",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title",2),e._uU(4,"eventual-consistent-spreadsheet"),e.qZA()()(),e.TgZ(5,"ion-grid")(6,"ion-row")(7,"ion-col")(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),e._uU(11,"State"),e.qZA()(),e.TgZ(12,"ion-card-content")(13,"ion-list")(14,"ion-item")(15,"ion-label"),e._uU(16),e.qZA()(),e.TgZ(17,"ion-item")(18,"ion-label"),e._uU(19),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-label"),e._uU(22),e.qZA()(),e.TgZ(23,"ion-item")(24,"ion-label"),e._uU(25),e.qZA()(),e.TgZ(26,"ion-item")(27,"ion-button",3),e.NdJ("click",function(){return t.fillTable()}),e._uU(28,"Fill table"),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-button",3),e.NdJ("click",function(){return t.clear()}),e._uU(31,"Clear table"),e.qZA()(),e.TgZ(32,"ion-item")(33,"form",4),e.NdJ("submit",function(){return t.grow(t.growQuantity)}),e.TgZ(34,"ion-input",5),e.NdJ("ngModelChange",function(l){return t.growQuantity=l}),e.qZA()()(),e.TgZ(35,"ion-item")(36,"ion-label"),e._uU(37),e.qZA()(),e.TgZ(38,"ion-item")(39,"ion-label"),e._uU(40),e.qZA()(),e.TgZ(41,"ion-item")(42,"ion-label"),e._uU(43),e.qZA()(),e.TgZ(44,"ion-item",6)(45,"ion-toggle",7),e.NdJ("ngModelChange",function(l){return t.isConnected=l}),e.TgZ(46,"ion-title"),e._uU(47,"Connected"),e.qZA()()()()()()(),e.TgZ(48,"ion-col")(49,"ion-card")(50,"ion-card-header")(51,"ion-card-title"),e._uU(52,"Testing"),e.qZA()(),e.TgZ(53,"ion-card-content")(54,"ion-item",6)(55,"ion-grid")(56,"ion-row")(57,"ion-input",8),e.NdJ("ngModelChange",function(l){return t.testSize=l}),e.qZA()(),e.TgZ(58,"ion-row")(59,"ion-input",9),e.NdJ("ngModelChange",function(l){return t.testRuns=l}),e.qZA()(),e.TgZ(60,"ion-row")(61,"ion-col",10)(62,"ion-toggle",11),e.NdJ("ngModelChange",function(l){return t.countBytes=l}),e.TgZ(63,"ion-title"),e._uU(64,"Count bytes"),e.qZA()()(),e.TgZ(65,"ion-col",10)(66,"ion-toggle",11),e.NdJ("ngModelChange",function(l){return t.measureTime=l}),e.TgZ(67,"ion-title"),e._uU(68,"Measure time"),e.qZA()()()(),e.TgZ(69,"ion-row")(70,"ion-button",3),e.NdJ("click",function(){return t.startTests()}),e._uU(71,"Start test"),e.qZA()()()()()()()(),e.TgZ(72,"ion-row")(73,"ion-col",10)(74,"ion-title",12),e._uU(75),e.qZA()(),e.TgZ(76,"ion-col"),e.YNc(77,b,3,1,"div",13),e.qZA()()(),e.TgZ(78,"div",14)(79,"table")(80,"thead")(81,"tr"),e._UZ(82,"th",15),e.YNc(83,E,9,1,"th",16),e.TgZ(84,"ion-button",17),e.NdJ("click",function(){return t.addColumn()}),e._UZ(85,"ion-icon",18),e.qZA()()(),e.TgZ(86,"tbody"),e.YNc(87,U,11,2,"tr",19),e.qZA()()(),e.TgZ(88,"ion-button",17),e.NdJ("click",function(){return t.addRow()}),e._UZ(89,"ion-icon",18),e.qZA()()),2&n&&(e.Q6J("fullscreen",!0),e.xp6(16),e.hij("Remote nodes: ",t.communication.nodes.size,""),e.xp6(3),e.hij("Time: ",t.trackedTime,""),e.xp6(3),e.hij("Exchanged bytes: ",t.countedBytes,""),e.xp6(3),e.hij("Exchanged messages: ",t.countedMessages,""),e.xp6(9),e.Q6J("ngModel",t.growQuantity),e.xp6(3),e.hij("Total bytes: ",t.totalBytes,""),e.xp6(3),e.hij("Received messages: ",t.communication.totalReceivedMessages,""),e.xp6(3),e.hij("Sent messages: ",t.communication.totalSentMessages,""),e.xp6(2),e.Q6J("ngModel",t.isConnected),e.xp6(12),e.Q6J("ngModel",t.testSize),e.xp6(2),e.Q6J("ngModel",t.testRuns),e.xp6(3),e.Q6J("ngModel",t.countBytes),e.xp6(4),e.Q6J("ngModel",t.measureTime),e.xp6(9),e.AsE("",null==t.currentCell?null:t.currentCell.columnIndex,"|",null==t.currentCell?null:t.currentCell.rowIndex,""),e.xp6(2),e.Q6J("ngIf",void 0!==t.currentCell),e.xp6(6),e.Q6J("ngForOf",t.spreadsheet.renderTable().columns),e.xp6(4),e.Q6J("ngForOf",t.spreadsheet.renderTable().rows))},dependencies:[p.sg,p.O5,h._Y,h.JJ,h.JL,h.On,h.F,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.Dq,r.wI,r.W2,r.jY,r.Gu,r.gu,r.pK,r.Ie,r.Q$,r.q_,r.Nd,r.wd,r.ho,r.sr,r.w,r.as,r.j9],styles:[".table-header[_ngcontent-%COMP%]{color:gray;text-align:center}.small-cell[_ngcontent-%COMP%]{width:120px}.cell[_ngcontent-%COMP%]{width:150px}.selected[_ngcontent-%COMP%]{border:solid 5px black;min-height:50px;min-width:150px}.spreadsheet[_ngcontent-%COMP%]{overflow-x:auto}.spreadsheet[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;width:100%}.spreadsheet[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .spreadsheet[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:solid 1px lightgray}"]}),s})()}];let J=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.Bz.forChild(A),m.Bz]}),s})(),k=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.ez,h.u5,r.Pc,J]}),s})()}}]);