"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8898],{3125:(g,h,d)=>{d.d(h,{O:()=>c});class i{constructor(n){this.counter=-1,this.range=n}next(){return void 0!==this.range&&this.counter===this.range&&(this.counter=-1),this.counter++,this.counter}current(){return this.counter}}class f{constructor(n,t){this._uuid=n,this.clock=new i(t)}static generate(){return new f(crypto.randomUUID())}get uuid(){return this._uuid}next(){return this._uuid+this.clock.next()}multiple(n){let t=[];for(let e=0;e<n;e++)t.push(this.next());return t}getLastId(){return this._uuid+this.clock.current()}}class r{constructor(){this._versionVector={}}update(n,t){return t===(this._versionVector[n]||-1)+1&&(this._versionVector[n]=t,!0)}get versionVector(){return this._versionVector}}class s{constructor(){this.records=new Map,this.buffer=[]}add(n){return n.timestamp=this.buffer.length,this.buffer.push(n),n}addNode(n,t=-1){this.records.set(n,t)}getMissingMessages(n,t=-1){return this.buffer.slice(t+1).map(e=>this.copyMessage(e,n))}copyMessage(n,t){return{source:n.source,destination:t,payload:n.payload,timestamp:n.timestamp}}getUnsentMessages(){let n=Array.from(this.records).flatMap(t=>this.getMissingMessages(t[0],t[1]));for(const t of this.records)this.records.set(t[0],this.buffer.length);return n}}var o=d(6689);let c=(()=>{class u{constructor(){this._identifier=f.generate(),this._nodes=new Set,this.messageBuffer=new s,this.versionVectorManager=new r,this._isConnected=!0,this._receivedMessageCounter=0,this._totalMessageCounter=0,this.onMessage=t=>{if(this._totalMessageCounter++,!this._isConnected)return;let e=t.data;var l;this.onNode(e.source),void 0!==e.versionVector&&this.sendMissingMessages(e.source,e.versionVector),void 0!==e.timestamp&&this.versionVectorManager.update(e.source,e.timestamp),e.destination===this._identifier.uuid&&void 0!==e.payload&&(this._receivedMessageCounter++,null===(l=this.observer)||void 0===l||l.onMessage(e.payload,e.source))}}openChannel(t,e){void 0!==this.channel&&this.closeChannel(),this.observer=e,this.channel=new BroadcastChannel(t),this.channel.onmessage=this.onMessage,this.advertiseSelf()}closeChannel(){void 0!==this.channel&&this.channel.close(),this.channel=void 0,this._nodes.clear(),this.messageBuffer=new s,this.versionVectorManager=new r,this._receivedMessageCounter=0,this._totalMessageCounter=0}postMessage(t){void 0!==this.channel&&void 0!==this.observer?(this._totalMessageCounter++,this.channel.postMessage(t)):console.warn("Cant post message, channel is undefined")}sendMissingMessages(t,e){this.messageBuffer.getMissingMessages(t,e[this._identifier.uuid]).forEach(a=>this.postMessage(a))}send(t,e){let l={source:this._identifier.uuid,destination:e,payload:t};return l=this.messageBuffer.add(l),void 0===e?(this._nodes.forEach(a=>{l.destination=a,this._isConnected&&this.postMessage(l)}),!0):(this._isConnected&&this.postMessage(l),!0)}onNode(t){let e=this._nodes.size;if(this._nodes.add(t),this._nodes.size>e){if(void 0===this.observer)return void console.warn("Observer is undefined");this.observer.onNode(t),this.messageBuffer.addNode(t),this.advertiseSelf()}}advertiseSelf(){this.postMessage({source:this._identifier.uuid,versionVector:this.versionVectorManager.versionVector})}set isConnected(t){this._isConnected=t,this._isConnected&&(this.messageBuffer.getUnsentMessages().forEach(e=>this.postMessage(e)),this.advertiseSelf())}get isConnected(){return this._isConnected}get nodes(){return this._nodes}get identifier(){return this._identifier}get receivedMessageCounter(){return this._receivedMessageCounter}get totalMessageCounter(){return this._totalMessageCounter}}return u.\u0275fac=function(t){return new(t||u)},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},7632:(g,h,d)=>{d.d(h,{M:()=>i});class i{constructor(r,s,o,c="",u){this._address=r,this._colIndex=s,this._rowIndex=o,this._input=c}get address(){return this._address}set address(r){this._address=r}get column(){return this._address.column}get row(){return this._address.row}get colIndex(){return this._colIndex}set colIndex(r){this._colIndex=r}get rowIndex(){return this._rowIndex}set rowIndex(r){this._rowIndex=r}get input(){return this._input}set input(r){this._input=r}get content(){return this._content}set content(r){this._content=r}}},5039:(g,h,d)=>{d.d(h,{O:()=>c});var i=d(7670);class s{constructor(){this.sortedVertices=[],this.vertices=new Map}addCell(n){this.vertices.set(n[0].column+"|"+n[0].row,{address:n[0],neighbours:n[1],visited:!1,discovered:!1,cyclical:!1})}sort(){let n=Array.from(this.vertices.values());for(;n.length>0;){let t=n.pop();this.visit(t)}return this.sortedVertices}visit(n){if(n.discovered)return;if(n.visited)return void(n.cyclical=!0);n.visited=!0;for(const e of n.neighbours){let l=this.vertices.get(e.column+"|"+e.row);null!=l&&this.visit(l)}n.discovered=!0;let t=this.sortedVertices.pop()||[];t.push(n.address),this.sortedVertices.push(t)}}var o=d(5820);class c{constructor(n){this.table=n}reset(){this.result=void 0}solve(){if(void 0===this.result){this.result=new i.i,this.table.rows.forEach(t=>{var e;return null===(e=this.result)||void 0===e?void 0:e.addRow(t)}),this.table.columns.forEach(t=>{var e;return null===(e=this.result)||void 0===e?void 0:e.addColumn(t)}),this.renderSimpleCells(this.table);let n=this.collectFormulas(this.table);this.renderFormulas(n,this.table),console.log("Table rendered")}return this.result}renderSimpleCells(n){for(const l of n.rows)for(const a of n.columns){let _={column:a,row:l},m=n.get(_);var t;if(void 0===m)null===(t=this.result)||void 0===t||t.set(_,{rawInput:"",content:void 0});else if("number"==typeof m.content||"string"==typeof m.content){var e;null===(e=this.result)||void 0===e||e.set(_,m)}}}collectFormulas(n){let t=[];for(const e of n.rows)for(const l of n.columns){let _=n.get({column:l,row:e});if(void 0!==_&&void 0!==_.content&&"object"==typeof(u=_.content)&&"type"in u&&"range"in u){let m=n.getAddressRange(_.content.range);t.push([{column:l,row:e},m])}}var u;return t}renderFormulas(n,t){let e=new s;n.filter(a=>{var _;return void 0===(null===(_=this.result)||void 0===_?void 0:_.get(a[0]))}).forEach(a=>e.addCell(a));for(const a of e.sort())for(const _ of a){var l;let m=t.get(_),p=this.computeFormula(m.content);null===(l=this.result)||void 0===l||l.set(_,{rawInput:m.rawInput,content:p})}}computeFormula(n){let t=this.result.getCellRange(n.range).map(e=>e.content).filter(e=>"number"==typeof e).map(e=>e);switch(n.type){case o.M.SUM:return 0!=t.length?t.reduce((e,l)=>e+l):0;case o.M.MAX:return Math.max.apply(null,t);case o.M.MIN:return Math.min.apply(null,t)}}}},5220:(g,h,d)=>{d.d(h,{t:()=>c});var i=d(7632),f=d(4499),r=d(7670),s=d(5039),o=d(6689);let c=(()=>{class u{constructor(){this.table=new r.i,this.spreadsheetSolver=new s.O(this.table),this.fillTable()}fillTable(){let t=0,e="init";for(let l=0;l<10;l++)this.addRow(e+t++),this.addColumn(e+t++);this.spreadsheetSolver.reset()}addRow(t){this.table.addRow(t),this.spreadsheetSolver.reset()}insertRow(t,e){this.table.insertRow(t,e),this.spreadsheetSolver.reset()}deleteRow(t){this.table.deleteRow(t),this.spreadsheetSolver.reset()}addColumn(t){this.table.addColumn(t),this.spreadsheetSolver.reset()}insertColumn(t,e){this.table.insertColumn(t,e),this.spreadsheetSolver.reset()}deleteColumn(t){this.table.deleteColumn(t),this.spreadsheetSolver.reset()}insertCellById(t,e){if(0===e.trim().length)this.deleteCell(t);else{let l=f.b.parseCell(e);this.table.set(t,l)}this.spreadsheetSolver.reset()}deleteCell(t){this.table.deleteValue(t),this.spreadsheetSolver.reset()}getTable(){return this.spreadsheetSolver.solve()}getCellById(t){let e=this.getTable().get(t),l=this.columns.indexOf(t.column)+1,a=this.rows.indexOf(t.row)+1;return new i.M(t,l,a,void 0===e?"":e.rawInput)}getCellByIndex(t,e){return this.getCellById({column:this.columns[t-1],row:this.rows[e-1]})}get rows(){return this.table.rows}get columns(){return this.table.columns}}return u.\u0275fac=function(t){return new(t||u)},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},1940:(g,h,d)=>{d.d(h,{U:()=>i});var i=(()=>((i=i||{}).ADD_ROW="ADD_ROW",i.INSERT_ROW="INSERT_ROW",i.DELETE_ROW="DELETE_ROW",i.ADD_COLUMN="ADD_COLUMN",i.INSERT_COLUMN="INSERT_COLUMN",i.DELETE_COLUMN="DELETE_COLUMN",i.INSERT_CELL="INSERT_CELL",i))()},5820:(g,h,d)=>{d.d(h,{M:()=>i});var i=(()=>((i=i||{}).SUM="SUM",i.MIN="MIN",i.MAX="MAX",i))()},7670:(g,h,d)=>{d.d(h,{i:()=>i});class i{constructor(){this._rows=[],this._columns=[],this._cells=new Map}addRow(r){this._rows.push(r)}insertRow(r,s){let o=this._rows.indexOf(s);-1!=o?this._rows.splice(o,0,r):console.log("Failed to insert id:"+r+" before id: "+s+" in rows: "+this._rows)}deleteRow(r){let s=this._rows.indexOf(r);-1!=s?this._rows.splice(s,1):console.log("Failed to remove id:"+r+" in rows: "+this._rows)}addColumn(r){this._columns.push(r)}insertColumn(r,s){let o=this._columns.indexOf(s);-1!=o?this._columns.splice(o,0,r):console.log("Failed to insert id:"+r+" before id: "+s+" in columns: "+this._columns)}deleteColumn(r){let s=this._columns.indexOf(r);-1!=s?this._columns.splice(s,1):console.log("Failed to remove id:"+r+" in columns: "+this._columns)}deleteValue(r){var s;null===(s=this.cells.get(r.row))||void 0===s||s.delete(r.column)}get(r){var s;return null===(s=this.cells.get(r.row))||void 0===s?void 0:s.get(r.column)}set(r,s){let o=this.cells.get(r.row)||new Map;o.set(r.column,s),this.cells.set(r.row,o)}getCellRange(r){return this.getAddressRange(r).filter(s=>{var o;return null!=(null===(o=this.cells.get(s.row))||void 0===o?void 0:o.get(s.column))}).map(s=>this.cells.get(s.row).get(s.column))}getAddressRange(r){let s=this._columns.indexOf(r[0].column),o=this._rows.indexOf(r[0].row),c=this._columns.indexOf(r[1].column),u=this._rows.indexOf(r[1].row);if(-1==s||-1==o||-1==c||-1==u)return[];let n=this._rows.slice(o,u+1),t=this._columns.slice(s,c+1),e=[];for(const l of n)for(const a of t)e.push({column:a,row:l});return e}get rows(){return this._rows}get columns(){return this._columns}get cells(){return this._cells}equals(r){return JSON.stringify(this._columns)===JSON.stringify(r._columns)&&JSON.stringify(this._rows)===JSON.stringify(r._rows)&&JSON.stringify(this._cells)===JSON.stringify(r._cells)}}},394:(g,h,d)=>{d.d(h,{rz:()=>f});var i=d(1940);function f(e){switch(e.action){case i.U.ADD_ROW:return function r(e){return e.action===i.U.ADD_ROW&&void 0!==e.input}(e);case i.U.INSERT_ROW:return function s(e){return e.action===i.U.INSERT_ROW&&void 0!==e.input&&void 0!==e.row}(e);case i.U.DELETE_ROW:return function o(e){return e.action===i.U.DELETE_ROW&&void 0!==e.row}(e);case i.U.ADD_COLUMN:return function c(e){return e.action===i.U.ADD_COLUMN&&void 0!==e.input}(e);case i.U.INSERT_COLUMN:return function u(e){return e.action===i.U.INSERT_COLUMN&&void 0!==e.input&&void 0!==e.column}(e);case i.U.DELETE_COLUMN:return function n(e){return e.action===i.U.DELETE_COLUMN&&void 0!==e.column}(e);case i.U.INSERT_CELL:return function t(e){return e.action===i.U.INSERT_CELL&&void 0!==e.input&&void 0!==e.row&&void 0!==e.column}(e);default:return!1}}},4499:(g,h,d)=>{d.d(h,{b:()=>f});var i=d(5820);class f{static parseCell(s){let o=+s;if(!Number.isNaN(o))return{rawInput:s,content:o};let c=this.parseFormula(s);return void 0!==c?{rawInput:s,content:c}:{rawInput:s,content:s}}static parseFormula(s){if(!s.includes("=")||!s.includes("(")||!s.includes(")"))return;let o=s.trim(),c=o.substring(1,o.indexOf("(")),u=i.M[c],n=o.substring(o.indexOf("(")+1,o.indexOf(")")),t=this.parseRange(n);return void 0!==t?{type:u,range:t}:void 0}static parseRange(s){let o=s.split(":");if(2!=o.length)return;let c=this.parse(o[0]),u=this.parse(o[1]);return null!=c&&null!=u?[c,u]:void 0}static parse(s){let o=s.split("|");if(2==o.length)return{column:o[0],row:o[1]}}}},6148:(g,h,d)=>{d.d(h,{Z:()=>f});var i=d(1940);class f{static addRow(s){return{column:void 0,row:void 0,action:i.U.ADD_ROW,input:s}}static insertRow(s,o){return{column:void 0,row:o,action:i.U.INSERT_ROW,input:s}}static deleteRow(s){return{column:void 0,row:s,action:i.U.DELETE_ROW,input:void 0}}static addColumn(s){return{column:void 0,row:void 0,action:i.U.ADD_COLUMN,input:s}}static insertColumn(s,o){return{column:o,row:void 0,action:i.U.INSERT_COLUMN,input:s}}static deleteColumn(s){return{column:s,row:void 0,action:i.U.DELETE_COLUMN,input:void 0}}static insertCell(s,o){return{column:s.column,row:s.row,action:i.U.INSERT_CELL,input:o}}}}}]);